{"ast":null,"code":"var _jsxFileName = \"/Users/fahmifirmansyah/Documents/Semester 6/Pemrograman_Berbasis_Framework/UAS/televisi-app/src/component/televisi/Televisi.jsx\";\nimport React, { Component } from 'react';\nimport firebase from 'firebase';\nimport firebaseConfig from '../../config';\nimport Post from './Post';\n\nclass Televisi extends Component {\n  constructor(props) {\n    super(props);\n\n    this.ambilDataDariServerAPI = () => {\n      const userRef = firebase.database().ref('televisi');\n      userRef.on('value', snapshot => {\n        let newUserState = [];\n        snapshot.forEach(data => {\n          const dataVal = data.val();\n          newUserState.push({\n            id: data.key,\n            nama: dataVal.nama,\n            harga: dataVal.harga,\n            gambar: dataVal.gambar,\n            stok: dataVal.stok\n          });\n        });\n        this.setState({\n          listTelevisi: newUserState\n        });\n        console.log(this.state);\n      });\n    };\n\n    this.getDatabyId = userId => {\n      // const Ref = firebase.database().ref('televisi/' + userId);\n      // Ref.on('value', (snapshot) => {\n      //   const data = snapshot.val();\n      //   this.writeData(data.id, data.nama, data.harga, data.gambar, data.stok);\n      //   console.log(data);\n      // })\n      const Ref = firebase.database().ref('keranjang/' + this.state.user.uid + userId);\n      Ref.on('value', snapshot => {\n        const data = snapshot.val();\n        this.writeData2(data.id, data.nama, data.harga, data.gambar, data.stok, this.state.user.uid, data.qty);\n        console.log(data);\n      });\n    };\n\n    this.writeData = (userId, name, price, imageUrl, stock) => {\n      var counter; // var counter2;\n\n      let uid = this.state.user.uid;\n      const userRef = firebase.database().ref('keranjang/' + uid + \"/\" + userId);\n      userRef.on('value', function (snapshot) {\n        if (snapshot.exists()) {\n          const data = snapshot.val(); // counter = data.qty + 1;\n\n          counter = true;\n          console.log(\"qty:\" + counter); // alert(counter);\n        }\n      });\n\n      if (counter) {\n        this.writeData2(userId, name, price, imageUrl, stock, uid);\n      } // counter2 = counter + 1;\n\n    };\n\n    this.writeData2 = (userId, name, price, imageUrl, stock, uid, counter) => {\n      firebase.database().ref('keranjang/' + uid + \"/\" + userId).set({\n        id: userId,\n        nama: name,\n        harga: price,\n        gambar: imageUrl,\n        stok: stock,\n        qty: counter\n      });\n    };\n\n    if (!firebase.apps.length) {\n      firebase.initializeApp(firebaseConfig);\n    } else {\n      firebase.app(); // if already initialized, use that one\n    }\n\n    this.state = {\n      listTelevisi: [],\n      user: {},\n      listKeranjang: []\n    };\n  }\n\n  authListener() {\n    firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        this.setState({\n          user\n        });\n        console.log(\"User adalah : \" + user.email);\n      } else {\n        this.setState({\n          user: null\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.ambilDataDariServerAPI();\n    this.authListener();\n    console.log(this.state);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    console.log(this.state);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"post-televisi\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"center\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 19\n      }\n    }, \"Daftar Barang\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tgh\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }\n    }, this.state.listTelevisi.map(televisi => {\n      // let uid = televisi.id;\n      return /*#__PURE__*/React.createElement(Post, {\n        key: televisi.id,\n        id: televisi.id,\n        nama: televisi.nama,\n        harga: televisi.harga,\n        gambar: televisi.gambar,\n        stok: televisi.stok // tambahTelevisi={this.handleGetTelevisi} />\n        ,\n        tambahTelevisi: this.getDatabyId,\n        users: this.state.user ? this.state.user.email : null,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 19\n        }\n      });\n    })));\n  }\n\n}\n\nexport default Televisi;","map":{"version":3,"sources":["/Users/fahmifirmansyah/Documents/Semester 6/Pemrograman_Berbasis_Framework/UAS/televisi-app/src/component/televisi/Televisi.jsx"],"names":["React","Component","firebase","firebaseConfig","Post","Televisi","constructor","props","ambilDataDariServerAPI","userRef","database","ref","on","snapshot","newUserState","forEach","data","dataVal","val","push","id","key","nama","harga","gambar","stok","setState","listTelevisi","console","log","state","getDatabyId","userId","Ref","user","uid","writeData2","qty","writeData","name","price","imageUrl","stock","counter","exists","set","apps","length","initializeApp","app","listKeranjang","authListener","auth","onAuthStateChanged","email","componentDidMount","componentDidUpdate","prevProps","prevState","render","map","televisi"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport firebase from 'firebase'\nimport firebaseConfig from '../../config'\nimport Post from './Post'\n\nclass Televisi extends Component {\n\n    constructor(props) {\n      super(props);\n  \n      if (!firebase.apps.length) {\n        firebase.initializeApp(firebaseConfig);\n      } else {\n        firebase.app(); // if already initialized, use that one\n      }\n  \n      this.state = {\n        listTelevisi: [],\n        user: {},\n        listKeranjang: []\n      }\n  \n    }\n  \n    authListener() {\n      firebase.auth().onAuthStateChanged((user) => {\n        if (user) {\n          this.setState({\n            user\n          })\n          console.log(\"User adalah : \" + user.email)\n        }\n        else {\n          this.setState({\n            user: null\n          })\n        }\n      })\n    }\n  \n    ambilDataDariServerAPI = () => {\n      const userRef = firebase.database().ref('televisi');\n      userRef.on('value', (snapshot) => {\n        let newUserState = [];\n        snapshot.forEach(data => {\n          const dataVal = data.val()\n          newUserState.push({\n            id: data.key,\n            nama: dataVal.nama,\n            harga: dataVal.harga,\n            gambar: dataVal.gambar,\n            stok: dataVal.stok\n          })\n        })\n        this.setState({\n          listTelevisi: newUserState\n        })\n        console.log(this.state);\n      })\n    }\n  \n    componentDidMount() {\n      this.ambilDataDariServerAPI();\n      this.authListener();\n      console.log(this.state)\n    }\n  \n    componentDidUpdate(prevProps, prevState) {\n      console.log(this.state);\n    }\n  \n    getDatabyId = userId => {\n      // const Ref = firebase.database().ref('televisi/' + userId);\n      // Ref.on('value', (snapshot) => {\n      //   const data = snapshot.val();\n      //   this.writeData(data.id, data.nama, data.harga, data.gambar, data.stok);\n      //   console.log(data);\n      // })\n\n      const Ref = firebase.database().ref('keranjang/' + this.state.user.uid + userId);\n      Ref.on('value', (snapshot) => {\n        const data = snapshot.val();\n        this.writeData2(data.id, data.nama, data.harga, data.gambar, data.stok, this.state.user.uid , data.qty);\n        console.log(data);\n      })\n    }\n  \n    writeData = (userId, name, price, imageUrl, stock) => {\n  \n      var counter;\n      // var counter2;\n      let uid = this.state.user.uid;\n  \n      const userRef = firebase.database().ref('keranjang/'+uid+\"/\"+userId);\n      userRef.on('value', function(snapshot) {\n          if (snapshot.exists()) {\n              const data = snapshot.val();\n              // counter = data.qty + 1;\n              counter = true;\n              console.log(\"qty:\"+counter);\n              // alert(counter);\n          }\n      })\n  \n      if(counter){\n        this.writeData2(userId, name, price, imageUrl, stock, uid);\n      }\n      // counter2 = counter + 1;\n\n    }\n\n    writeData2 = (userId, name, price, imageUrl, stock, uid, counter) => {\n      firebase.database().ref('keranjang/' + uid +\"/\"+ userId).set({\n        id: userId,\n        nama: name,\n        harga: price,\n        gambar: imageUrl,\n        stok: stock,\n        qty: counter\n      });\n    }\n  \n    render() {\n      return (\n        <div className=\"post-televisi\">\n          {\n                  /* <div className=\"form pb-2 border-bottom\">\n                      <button type=\"submit\" className=\"btn btn-primary\" onClick={this.handleTombolSimpan}>Simpan</button>\n                  </div> */}\n          <center><h2>Daftar Barang</h2></center>\n          <div className=\"tgh\">\n            {\n              this.state.listTelevisi.map(televisi => {\n                // let uid = televisi.id;\n                return (\n                  <Post\n                    key={televisi.id}\n                    id={televisi.id}\n                    nama={televisi.nama}\n                    harga={televisi.harga}\n                    gambar={televisi.gambar}\n                    stok={televisi.stok}\n                    // tambahTelevisi={this.handleGetTelevisi} />\n                    tambahTelevisi={this.getDatabyId}\n                    users={this.state.user ? this.state.user.email : null} />\n                )\n              })\n            }\n          </div>\n        </div>\n      )\n    }\n  }\n\nexport default Televisi;"]},"metadata":{},"sourceType":"module"}