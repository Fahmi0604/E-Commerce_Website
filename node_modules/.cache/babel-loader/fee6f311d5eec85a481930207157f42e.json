{"ast":null,"code":"var _jsxFileName = \"/Users/fahmifirmansyah/Documents/Semester 6/Pemrograman_Berbasis_Framework/UAS/televisi-app/src/component/televisi/Televisi.jsx\";\nimport React, { Component } from 'react';\nimport firebase from 'firebase';\nimport firebaseConfig from '../../config';\nimport Post from './Post';\n\nclass Televisi extends Component {\n  constructor(props) {\n    super(props);\n\n    this.ambilDataDariServerAPI = () => {\n      const userRef = firebase.database().ref('televisi');\n      userRef.on('value', snapshot => {\n        let newUserState = [];\n        snapshot.forEach(data => {\n          const dataVal = data.val();\n          newUserState.push({\n            id: data.key,\n            nama: dataVal.nama,\n            harga: dataVal.harga,\n            gambar: dataVal.gambar,\n            stok: dataVal.stok\n          });\n        });\n        this.setState({\n          listTelevisi: newUserState\n        });\n        console.log(this.state);\n      });\n    };\n\n    this.getDatabyId = userId => {\n      const Ref = firebase.database().ref('televisi/' + userId);\n      let idP, namaP, hargaP, gambarP, stokP;\n      Ref.on('value', snapshot => {\n        const data = snapshot.val();\n        this.writeData(data.id, data.nama, data.harga, data.gambar, data.stok);\n        idP = data.id;\n        namaP = data.nama;\n        hargaP = data.harga;\n        gambarP = data.gambar;\n        stokP = data.stok;\n        console.log(data);\n      }); // Ref.set({\n      //   id: idP,\n      //   nama: namaP,\n      //   harga: hargaP,\n      //   gambar: gambarP,\n      //   stok: stokP - 1,\n      // })\n    };\n\n    this.writeData = (userId, name, price, imageUrl, stock) => {\n      var counter = 0; // var counter2;\n\n      let uid = this.state.user.uid;\n      const userRef = firebase.database().ref('keranjang/' + uid + \"/\" + userId);\n      userRef.on('value', function (snapshot) {\n        if (snapshot.exists()) {\n          const data = snapshot.val();\n          counter = data.qty;\n          console.log(\"qty:\" + counter); // alert(counter);\n        }\n      }); // counter2 = counter + 1;\n\n      firebase.database().ref('keranjang/' + uid + \"/\" + userId).set({\n        id: userId,\n        nama: name,\n        harga: price,\n        gambar: imageUrl,\n        stok: stock,\n        qty: counter + 1\n      });\n    };\n\n    if (!firebase.apps.length) {\n      firebase.initializeApp(firebaseConfig);\n    } else {\n      firebase.app(); // if already initialized, use that one\n    }\n\n    this.state = {\n      listTelevisi: [],\n      user: {},\n      listKeranjang: []\n    };\n  }\n\n  authListener() {\n    firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        this.setState({\n          user\n        });\n        console.log(\"User adalah : \" + user.email);\n      } else {\n        this.setState({\n          user: null\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.ambilDataDariServerAPI();\n    this.authListener();\n    console.log(this.state);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    console.log(this.state);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"post-televisi\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"center\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 19\n      }\n    }, \"Daftar Barang\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tgh\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }\n    }, this.state.listTelevisi.map(televisi => {\n      // let uid = televisi.id;\n      return /*#__PURE__*/React.createElement(Post, {\n        key: televisi.id,\n        id: televisi.id,\n        nama: televisi.nama,\n        harga: televisi.harga,\n        gambar: televisi.gambar,\n        stok: televisi.stok // tambahTelevisi={this.handleGetTelevisi} />\n        ,\n        tambahTelevisi: this.getDatabyId,\n        users: this.state.user ? this.state.user.email : null,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 19\n        }\n      });\n    })));\n  }\n\n}\n\nexport default Televisi;","map":{"version":3,"sources":["/Users/fahmifirmansyah/Documents/Semester 6/Pemrograman_Berbasis_Framework/UAS/televisi-app/src/component/televisi/Televisi.jsx"],"names":["React","Component","firebase","firebaseConfig","Post","Televisi","constructor","props","ambilDataDariServerAPI","userRef","database","ref","on","snapshot","newUserState","forEach","data","dataVal","val","push","id","key","nama","harga","gambar","stok","setState","listTelevisi","console","log","state","getDatabyId","userId","Ref","idP","namaP","hargaP","gambarP","stokP","writeData","name","price","imageUrl","stock","counter","uid","user","exists","qty","set","apps","length","initializeApp","app","listKeranjang","authListener","auth","onAuthStateChanged","email","componentDidMount","componentDidUpdate","prevProps","prevState","render","map","televisi"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport firebase from 'firebase'\nimport firebaseConfig from '../../config'\nimport Post from './Post'\n\nclass Televisi extends Component {\n\n    constructor(props) {\n      super(props);\n  \n      if (!firebase.apps.length) {\n        firebase.initializeApp(firebaseConfig);\n      } else {\n        firebase.app(); // if already initialized, use that one\n      }\n  \n      this.state = {\n        listTelevisi: [],\n        user: {},\n        listKeranjang: []\n      }\n  \n    }\n  \n    authListener() {\n      firebase.auth().onAuthStateChanged((user) => {\n        if (user) {\n          this.setState({\n            user\n          })\n          console.log(\"User adalah : \" + user.email)\n        }\n        else {\n          this.setState({\n            user: null\n          })\n        }\n      })\n    }\n  \n    ambilDataDariServerAPI = () => {\n      const userRef = firebase.database().ref('televisi');\n      userRef.on('value', (snapshot) => {\n        let newUserState = [];\n        snapshot.forEach(data => {\n          const dataVal = data.val()\n          newUserState.push({\n            id: data.key,\n            nama: dataVal.nama,\n            harga: dataVal.harga,\n            gambar: dataVal.gambar,\n            stok: dataVal.stok\n          })\n        })\n        this.setState({\n          listTelevisi: newUserState\n        })\n        console.log(this.state);\n      })\n    }\n  \n    componentDidMount() {\n      this.ambilDataDariServerAPI();\n      this.authListener();\n      console.log(this.state)\n    }\n  \n    componentDidUpdate(prevProps, prevState) {\n      console.log(this.state);\n    }\n  \n    getDatabyId = userId => {\n      const Ref = firebase.database().ref('televisi/' + userId);\n\n      let idP, namaP, hargaP, gambarP, stokP;\n\n      Ref.on('value', (snapshot) => {\n        const data = snapshot.val();\n        this.writeData(data.id, data.nama, data.harga, data.gambar, data.stok);\n        idP=data.id\n        namaP=data.nama\n        hargaP=data.harga\n        gambarP=data.gambar\n        stokP=data.stok\n        console.log(data);\n      })\n\n      // Ref.set({\n      //   id: idP,\n      //   nama: namaP,\n      //   harga: hargaP,\n      //   gambar: gambarP,\n      //   stok: stokP - 1,\n      // })\n    }\n  \n    writeData = (userId, name, price, imageUrl, stock) => {\n  \n      var counter=0;\n      // var counter2;\n      let uid = this.state.user.uid;\n  \n      const userRef = firebase.database().ref('keranjang/'+uid+\"/\"+userId);\n      userRef.on('value', function(snapshot) {\n          if (snapshot.exists()) {\n              const data = snapshot.val();\n              counter = data.qty;\n              console.log(\"qty:\"+counter);\n              // alert(counter);\n          }\n      })\n      // counter2 = counter + 1;\n\n      firebase.database().ref('keranjang/' + uid +\"/\"+ userId).set({\n        id: userId,\n        nama: name,\n        harga: price,\n        gambar: imageUrl,\n        stok: stock,\n        qty: counter + 1\n      });\n    }\n  \n    render() {\n      return (\n        <div className=\"post-televisi\">\n          {\n                  /* <div className=\"form pb-2 border-bottom\">\n                      <button type=\"submit\" className=\"btn btn-primary\" onClick={this.handleTombolSimpan}>Simpan</button>\n                  </div> */}\n          <center><h2>Daftar Barang</h2></center>\n          <div className=\"tgh\">\n            {\n              this.state.listTelevisi.map(televisi => {\n                // let uid = televisi.id;\n                return (\n                  <Post\n                    key={televisi.id}\n                    id={televisi.id}\n                    nama={televisi.nama}\n                    harga={televisi.harga}\n                    gambar={televisi.gambar}\n                    stok={televisi.stok}\n                    // tambahTelevisi={this.handleGetTelevisi} />\n                    tambahTelevisi={this.getDatabyId}\n                    users={this.state.user ? this.state.user.email : null} />\n                )\n              })\n            }\n          </div>\n        </div>\n      )\n    }\n  }\n\nexport default Televisi;"]},"metadata":{},"sourceType":"module"}